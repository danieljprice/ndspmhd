To compile SUPERSPHPLOT you will need the following on your system, both of whic
are freely available:
- The PGPLOT graphics subroutine library
- A Fortran 95 compiler

The basic steps for installation are:
1) make sure you have a Fortran 90/95 compiler (such as g95)
2) make sure you have the PGPLOT libraries installed
3) compile SUPERSPHPLOT and link with PGPLOT
4) if desired/necessary write a read_data subroutine so that SUPERSPHPLOT can read your data format

For troubleshooting of some common installation problems,
 have a look at the online FAQ.

1) ---------------- Fortran 95 compilers ---------------------------

 By now, many Fortran 90/95 compilers exist. In terms of free ones, the Intel compiler has a
non-commercial version available for linux and the g95 compiler, downloadable from:

http://www.g95.org

successfully compiles SUPERSPHPLOT and if necessary the PGPLOT
libraries. 

2) ------------------- PGPLOT -----------------------------------------
The PGPLOT graphics subroutine library is freely downloadable from

http://www.astro.caltech.edu/~tjp/pgplot/

or by ftp from

ftp://ftp.astro.caltech.edu/pub/pgplot/pgplot5.2.tar.gz

however check to see if it is already installed on your system (if so, the libraries are
usually located in /usr/local/pgplot).


3) ------------------- Compiling the code (the short way) --------------------------------

Once you have a copy of PGPLOT installed, preset options for the most common Fortran compilers are
given in the Makefile provided an environment variable called SYSTEM is set appropriately.
Typing 'make' will give you the following message:

 make: WARNING: value of SYSTEM =  not recognised...
 =>set the environment variable SYSTEM to one listed 
   in the Makefile and try again

options for the SYSTEM variable for compiling the code are:

g95 -- settings for the g95 compiler
nagf95 -- settings for the NAG f95 compiler
sunf95 -- settings for the Sun f95 compiler
ifort -- settings for the Intel Fortran Compiler
pgf90 -- settings for the Portland Group Fortran 90 compiler

options which compile and also link PGPLOT on specific machines are:

mymac -- settings for a Mac using g95 with PGPLOT installed via fink
ukaff1a -- settings for the ukaff1a supercomputer

for a full list, have a look in the Makefile itself. To set the SYSTEM variable, in a sh/bash shell type

export SYSTEM='mymac'

or under csh/tcsh type

setenv SYSTEM 'mymac'

then simply type 'make', which will compile the code using the presets corresponding to your choice of
SYSTEM variable. Unless you have used one of the SYSTEM presets that also links to PGPLOT, you will probably
need to manually change the link-time settings (see step 3b, below).

3a) ------------------- Compiling the code (more generally) --------------------------------
In the Makefile, you will need to set the Fortran compiler and flags to your local version, e.g..

F90C = g95
F90FLAGS = -O

importantly, on some compilers you will need to make sure that backslashes (\) are treated as normal
characters. For example on the following compilers you should use:

intel fortran compiler:
F90C = ifc/ifort
F90FLAGS = -O -nbs

portland group fortran:
F90C = pgf90
F90FLAGS = -O -Mbackslash

3b) ------------------- linking with PGPLOT libraries ---------------------
 Secondly the compiler must be able to link to the PGPLOT and X11 libraries on
your system. The settings for these are given at the top of the Makefile by the settings:

X11LIBS= -lX11
PGPLOTLIBS= -lpgplot

If that works at a first attempt, take a moment to think several happy thoughts about your system
administrator. If these libraries are not found, you will need to enter the
library paths by hand. On most systems this is something like:

X11LIBS= -L/usr/X11R6/lib -lX11
PGPLOTLIBS= -L/usr/local/pgplot -lpgplot

(assuming the PGPLOT libraries are in the /usr/local/pgplot directory and the
X11 libraries are in /usr/X11R6/lib). If this does not work, try using the
"locate" command to find the libraries on your system:

crap>locate libpgplot

crap>locate libX11

 If, having found the PGPLOT and X11
libraries, the program still won't compile, it is usually
because the PGPLOT on your system has been compiled with a different compiler to
the one you are using, and the libraries from that compiler must also be linked.
For g77-compiled PGPLOT (very common) the relevant library is g2c, so use:

PGPLOTLIBS = -L/usr/local/pgplot -lpgplot -lg2c

If the PNG drivers are incorporated into the PGPLOT installation, the -lpng libraries must also be added.
Failing that, ask your system administrator(!) or simply download your own copy of
the PGPLOT libraries and make sure it is compiled with the same compiler as you
are using to compile the SUPERSPHPLOT source code (e.g. g95).

 Secondly, you will need to modify the system-dependent routines for your
compiler. These are specified via the settings:

SYSTEMFILE = system_unix.f90 

which works for most unix-based compilers (including g95). A file system_unix_NAG
is included for the NAG f95 compiler. A version for Fortran 2003 compatible
compilers (such as g95) is also given (system_f2003.f90).

At present the only calls to these routines are made from supersphplot.f90 which
reads the run name(s) from the command line. A standardised format for performing this
task is included in the standards for the next release of Fortran (Fortran 2003),
however in the meantime the calls in the system module may require some adjustment depending on the
particular system you are compiling the code on. The program is still fully
functional without this call working, but it does make things convenient (in particular it means that
SUPERSPHPLOT can be invoked using wildcards (*,?) in filenames).

If you are still stuck at this point, have a look at the online FAQ for some common problems, or feel free
to email me.

4) -------------- writing your data_read subroutine -------------------

If you are using a publically available code (e.g. GADGET), it is reasonably likely that I
have already written a read data subroutine which will read your dumps.
If not it is best to look at some of the other examples and change the 
necessary parts to suit your data files. Note that reading directly from
unformatted data files is *much* faster than reading from formatted (ascii)
output. Just to get started you can use the read_data_ascii.f90 which reads
from ascii files, but this will not enable the full rendering capabilities
until you specify the location of the density, h and particle mass in the
arrays (via the parameters ih, irho and ipmass in the set_labels subroutine
which is part of the read_data file). 

Perhaps the best way in a small community is simply to email me
a sample data file and the subroutine which writes it and I can easily modify a data read to your
particular format.


Have fun! And remember, if you get stuck you can always email me... (it doesn't hurt).

Daniel Price
dprice@astro.ex.ac.uk
